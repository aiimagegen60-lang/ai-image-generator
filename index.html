<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>AI Image Generator</title>

<style>
body{margin:0;background:#0b0b0b;color:#fff;font-family:Arial}
header{padding:14px;text-align:center;font-size:20px;background:#161616}
.container{padding:15px}
textarea{width:100%;height:90px;padding:12px;border-radius:10px;border:none}
button{width:100%;margin-top:12px;padding:14px;font-size:16px;
border:none;border-radius:10px;font-weight:bold;background:#00e676}
#status{margin-top:10px;color:#aaa;text-align:center}
#imgBox{margin-top:15px}
#imgBox img{width:100%;border-radius:12px;display:none}
</style>
</head>

<body>

<header>ü§ñ AI Image Generator</header>

<div class="container">
<textarea id="prompt" placeholder="Describe your image..."></textarea>
<button onclick="generate()">‚ö° Generate Image</button>

<div id="status"></div>

<div id="imgBox">
  <img id="img">
</div>
</div>

<script>
const WORKER_URL = "https://fragrant-salad-e7eb.aiimagegen60.workers.dev";

let retry = 0;

async function generate(){
  const prompt = document.getElementById("prompt").value.trim();
  const status = document.getElementById("status");
  const img = document.getElementById("img");

  if(!prompt){
    alert("Enter prompt");
    return;
  }

  status.innerText = "‚è≥ Generating image‚Ä¶";
  img.style.display = "none";

  try{
    const res = await fetch(WORKER_URL,{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify({prompt})
    });

    if(!res.ok){
      if(retry < 1){
        retry++;
        status.innerText = "üî• Warming up server‚Ä¶ retrying";
        setTimeout(generate,3000);
        return;
      }
      status.innerText = "‚ö†Ô∏è Server busy. Try again.";
      retry = 0;
      return;
    }

    const type = res.headers.get("content-type") || "";
    if(!type.startsWith("image/")){
      status.innerText = "‚ö†Ô∏è Image service busy. Try again.";
      return;
    }

    const blob = await res.blob();
    img.src = URL.createObjectURL(blob);
    img.style.display = "block";
    status.innerText = "‚úÖ Done";
    retry = 0;

  }catch{
    status.innerText = "‚ùå Network error";
  }
}
</script>

</body>
</html>
